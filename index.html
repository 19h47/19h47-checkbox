<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />
		<title>Checkbox</title>
		<link rel="icon" type="image/png" href="check-box-with-check.png" />
		<link
			rel="stylesheet"
			href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
			integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
			crossorigin="anonymous"
		/>

		<style>
			.Form__checkbox button {
				width: 1.5rem;
				height: 1.5rem;
				position: relative;
				border: 1px solid black;
			}

			.Form__checkbox button::after {
				display: block;
				position: absolute;
				top: 0;
				right: 0;
				bottom: 0;
				left: 0;
				margin: 3px;
				content: '';
			}

			.Form__checkbox.is-selected button:after {
				background-color: black;
			}

			.Form__checkbox.is-off,
			.Form__checkbox[disabled] {
				opacity: 0.3;
				pointer-events: none;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="row my-5">
				<div class="col-12">
					<h1 class="m-0">
						<a href="https://github.com/19h47/19h47-checkbox"
							>Checkbox<sup class="js-value">Mustard</sup></a
						>
					</h1>
				</div>
			</div>

			<div class="row my-5">
				<div class="col-12">
					<div class="border p-3">
						<h3 id="sandwich-condiments">Sandwich Condiments</h3>

						<div role="group" aria-labelledby="sandwich-condiments">
							<div
								class="Form__checkbox m-3 align-items-center d-flex"
								tabindex="0"
								role="checkbox"
								aria-checked="false"
							>
								<button class="mr-3" type="button" tabindex="-1"></button>Lettuce
								<div class="d-none">
									<input
										id="lettuce"
										name="lettuce"
										value="Lettuce"
										type="checkbox"
									/>
								</div>
							</div>

							<div
								class="Form__checkbox m-3 align-items-center d-flex"
								tabindex="0"
								role="checkbox"
								aria-checked="false"
							>
								<button class="mr-3" type="button" tabindex="-1"></button>Tomato
								<div class="d-none">
									<input
										id="tomato"
										name="tomato"
										value="Tomato"
										type="checkbox"
									/>
								</div>
							</div>

							<fieldset class="border">
								<div
									class="Form__checkbox m-3 align-items-center d-flex js-tomato is-off"
									tabindex="-1"
									disabled
									role="checkbox"
									aria-checked="false"
								>
									<button class="mr-3" type="button" tabindex="-1"></button>Roma
									<div class="d-none">
										<input id="roma" name="roma" value="Roma" type="checkbox" />
									</div>
								</div>

								<div
									class="Form__checkbox m-3 align-items-center d-flex js-tomato is-off"
									tabindex="-1"
									disabled
									role="checkbox"
									aria-checked="false"
								>
									<button class="mr-3" type="button" tabindex="-1"></button
									>Monterosa
									<div class="d-none">
										<input
											id="monterosa"
											name="monterosa"
											value="Monterosa"
											type="checkbox"
										/>
									</div>
								</div>

								<div
									class="Form__checkbox m-3 align-items-center d-flex js-tomato is-off"
									tabindex="-1"
									disabled
									role="checkbox"
									aria-checked="false"
								>
									<button class="mr-3" type="button" tabindex="-1"></button
									>Beefsteak
									<div class="d-none">
										<input
											id="beefsteak"
											name="beefsteak"
											value="Beefsteak"
											type="checkbox"
										/>
									</div>
								</div>
							</fieldset>

							<div
								class="Form__checkbox m-3 align-items-center d-flex is-selected"
								tabindex="0"
								role="checkbox"
								aria-checked="true"
							>
								<button
									class="mr-3 is-selected"
									type="button"
									tabindex="-1"
								></button
								>Mustard
								<div class="d-none">
									<input
										id="mustard"
										name="mustard"
										value="Mustard"
										type="checkbox"
										checked
									/>
								</div>
							</div>

							<div
								class="Form__checkbox m-3 align-items-center d-flex"
								tabindex="0"
								role="checkbox"
								aria-checked="false"
							>
								<button class="mr-3" type="button" tabindex="-1"></button>
								<div>Sprouts</div>
								<div class="d-none">
									<input
										id="sprouts"
										name="sprouts"
										value="Sprouts"
										type="checkbox"
									/>
								</div>
							</div>

							<div
								class="Form__checkbox mx-3 mt-3 align-items-center d-flex disabled"
								role="checkbox"
								aria-checked="false"
								aria-disabled="true"
								tabindex="-1"
								disabled
							>
								<button class="mr-3" type="button" tabindex="-1"></button>
								<div>Disabled</div>
								<div class="d-none">
									<input
										id="disabled"
										name="disabled"
										value="Disabled"
										type="checkbox"
									/>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<script src="main.js"></script>
		<script>
			const elements = document.querySelectorAll('[role="checkbox"]');
			const $value = document.querySelector('.js-value');
			const tomatoes = [];

			for (let i = 0; i < elements.length; i++) {
				const $element = elements[i];
				const checkbox = new Checkbox.default($element);

				checkbox.init();

				if ($element.classList.contains('js-tomato')) {
					tomatoes.push(checkbox);
				}

				checkbox.$input.addEventListener('activate', event => {
					const {
						target: { value },
					} = event;
					$value.innerHTML = value;

					if ('Tomato' === value) {
						tomatoes.forEach(tomato => {
							tomato.rootElement.classList.remove('is-off');
							tomato.rootElement.setAttribute('tabIndex', 0);
							tomato.rootElement.removeAttribute('disabled');
							tomato.activate();
						});
					}
				});

				checkbox.$input.addEventListener('deactivate', event => {
					const {
						target: { value },
					} = event;

					if ('Tomato' === value) {
						tomatoes.forEach(tomato => {
							tomato.rootElement.classList.add('is-off');
							tomato.rootElement.setAttribute('tabIndex', -1);
							tomato.deactivate();
						});
					}
				});
			}
		</script>
	</body>
</html>
